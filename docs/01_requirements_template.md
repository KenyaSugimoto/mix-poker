# 要件定義書 (Requirements Definition Document)

## 1. プロジェクト概要
**プロダクト名**: Mixゲームアプリ (仮)
**目的**: 複数のポーカールール（Mixゲーム）に対応したWebアプリを開発する。長期的にはHORSEなどのMixゲーム実装を目指すが、まずは**Seven Card Stud Hi**単体での実装を通じて、マルチゲーム対応可能なアーキテクチャの検証を行う。

## 2. 開発スコープ (MVP: Phase 1)
まずは以下のスコープで開発を行い、アーキテクチャの妥当性を検証する。

- **対象ゲーム**: Seven Card Stud (Highのみ)
- **プラットフォーム**: Webブラウザ (PC/スマホレスポンシブ対応)
- **対戦形式**: シングルプレイヤー vs CPU (2~7人卓)
- **保存機能**: ブラウザローカルストレージ (localStorage) ※優先度低

## 3. 機能要件

### 3.1 ゲーム進行 (Seven Card Stud)
- **基本ルール**: 一般的なSeven Card Stud Highルールに準拠。
- **ベッティング構造**: Fixed Limit (FL)
  - Ante
  - Bring-in
  - Completion (Small Bet)
  - Street Betting (3rd, 4th, 5th, 6th, 7th street)
  - ※4th Streetでのペア発生時のダブルベットオプションは**不要**（標準ルールのみ）。
- **アクション**:
  - **3rd Street特有**:
    - Bring-inプレイヤー: `Bring-in` か `Complete` のみ選択可能。
    - 以降のプレイヤー: `Fold`, `Call` (bring-in額に対して), `Complete` (Small Bet額にする) が基本。
    - 既にCompleteが入っている場合: `Raise` が可能になる（Completeの選択肢はなくなる）。
  - **4th Street以降**:
    - `Fold`, `Check`, `Call`, `Bet`, `Raise`
		- アクション不可なものは表示しない
- **勝敗判定**:
  - ショウダウン時の役判定 (Highハンドのみ)
  - ポット分配 (Split Pot対応)

### 3.2 ゲーム設定
- **プレイヤー人数**: 2人 ~ 7人 (ユーザー1名 + CPU 1~6名)
- **ステークス**: 固定設定 (初期検証用)
  - Stud系: Ante $5 / Bring-in $10 / Small Bet $40 / Big Bet $80
  - FL: Small Blind $20 / Big Blind $40
  - PL/NL: Small Blind $10 / Big Blind $20 / BB Ante $20
  - ※UIではチップ額として表示

### 3.3 CPUロジック (基本的戦略)
- ランダムアクションではなく、最低限のポーカー定石を実装する。
  - **フォールド判断**: 明らかに勝率の低いハンド（ゴミ手）は降りる。
  - **ベット判断**: 強い役（ペアやスリーカードなど）が見えている/完成している場合はベット/レイズする。
  - **ブラフ**: 現段階では実装しない、または低確率でのみ行う。

### 3.4 データ永続化 (リロード耐性)
- **優先度**: 低 (Low)
- **内容**: 余裕があればlocalStorageへの保存を実装するが、MVPの必須要件としては強く求めない。

## 4. UI/UX要件

### 4.1 デザインコンセプト
- **テーマ**: ダークモード、高級感 (Luxury)
- **リファレンス**: PokerStarsのような、洗練されたプロフェッショナルな雰囲気。
- **視認性**:
  - カード、チップ、アクションボタンが明確に識別できること。
  - Stud特有の「全プレイヤーのフェイスアップカード」が見やすく配置されていること。
  - **アクションフィードバック**: プレイヤーがアクションを行った際、その内容（Bet $10等）を一時的に表示する。
  - **演出**: ハンド終了時、獲得ポット額をアニメーション付きで表示する。

### 4.2 画面構成・モバイル対応
1.  **タイトル/設定画面**:
    - ゲーム開始ボタン
    - 人数設定など
2.  **メインゲーム画面**:
    - **テーブル**: 陸上競技場型 (Racetrack shape)
    - **座席配置**: ユーザーはテーブル下部中央(6時方向)固定。
    - **モバイル対応 (Critical)**:
        - スマホ表示時でも各コンポーネント（カード、チップ、ボタン）が画面外にはみ出ないこと。
        - 隠れて見えなくならないよう、レイアウトを最適化する（例：アクションパネルの高さを抑える、カードサイズを適切に調整するなど）。

## 5. 技術スタック
- **Frontend**: React, Vite
- **Language**: TypeScript
- **Styling**: Tailwind CSS (Tailwind Merge, clsx等で管理)
- **State Management**: Zustand (イミュータブルな状態更新により、ログ機能やUndo実装への拡張性を確保)
- **Testing**: Vitest (ロジック部分のユニットテスト重視)
- **Formatter/Linter**: Biome

## 6. 今後の拡張性 (Consideration)
今回のMVPではStud単体だが、以下の点を考慮した設計（インターフェース設計）を行う。
- **Game Engine抽象化**: `IGameEngine` のようなインターフェースを定義し、将来的にHold'emやOmahaを追加しやすいようにする。
- **Table State分離**: 「座席」「チップ」「カード配布」など、ゲームルールに依存しない共通コンポーネントと、ルール固有のロジックを分離する。
